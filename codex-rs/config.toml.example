# Example Planner configuration
# Save as ~/.code/config.toml

# Model configuration
model = "gpt-5-codex"
model_provider = "openai"

# ACE (Agentic Context Engine) integration
# Provides compounding strategy memory for spec-kit workflows
[ace]
# Enable/disable ACE integration (default: true)
enabled = true

# When to use ACE (default: "auto")
# - "auto": Use for commands in use_for list
# - "always": Use for all spec-kit commands
# - "never": Disable ACE completely
mode = "auto"

# Number of playbook bullets to inject (max 8 recommended)
slice_size = 8

# SQLite database path for ACE playbooks
db_path = "~/.code/ace/playbooks_v1.sqlite3"

# Commands that should receive ACE playbook injection
use_for = [
    "speckit.constitution",
    "speckit.clarify",
    "speckit.analyze",
    "speckit.checklist",
    "speckit.specify",
    "speckit.tasks",
    "speckit.implement",
    "speckit.test"
]

# File count threshold for routing to ace.generate (complexity heuristic)
complex_task_files_threshold = 4

# Rerun detection window in minutes
rerun_window_minutes = 30

# MCP servers configuration
[mcp_servers.ace]
command = "python"
args = ["-m", "ace_mcp_server"]

# Optional: environment variables for ACE server
# env = { ACE_LOG_LEVEL = "info" }

# Example: Local memory MCP server
[mcp_servers.local-memory]
command = "npx"
args = ["-y", "@theturtlecsz/local-memory-mcp"]

# Agent configuration for multi-agent workflows
# Use canonical_name to enable resolution across TUI/CLI/headless

[[agents]]
name = "claude-haiku"
canonical_name = "claude"  # Resolved from prompts.json agent names
command = "claude"
enabled = true
description = "Claude for validation and synthesis"

[[agents]]
name = "gemini-flash"
canonical_name = "gemini"  # Resolved from prompts.json agent names
command = "gemini"
enabled = true
description = "Gemini for research and analysis"

[[agents]]
name = "code"
canonical_name = "code"
command = "code"
enabled = true
description = "Claude Code for implementation"

# GPT agents (SPEC-KIT-981: Default for all stages)
[[agents]]
name = "gpt-5.2-architect"
canonical_name = "gpt_pro"  # Used for architect/judge roles
command = "openai-chat"
args = ["--model", "gpt-5.2"]
enabled = true
description = "GPT-5.2 for architect/planner/judge roles"

[[agents]]
name = "gpt-5.2-codex"
canonical_name = "gpt_codex"  # Used for implementer role
command = "openai-chat"
args = ["--model", "gpt-5.2-codex"]
enabled = true
description = "GPT-5.2 Codex for code generation"

# Spec-Kit stageâ†’agent mapping (SPEC-KIT-981)
# Override default routing (all stages default to GPT)
# Valid values: gpt_pro, gpt_codex, gemini, claude, code
[speckit.stage_agents]
# Uncomment to override defaults:
# specify = "gpt_pro"      # PRD generation
# plan = "gpt_pro"         # Architecture planning
# tasks = "gpt_pro"        # Task breakdown
# implement = "gpt_codex"  # Code generation (default: gpt_codex)
# validate = "gpt_pro"     # Validation
# audit = "gpt_pro"        # Security/quality audit
# unlock = "gpt_pro"       # Release gates
# clarify = "gpt_pro"      # Ambiguity resolution
# analyze = "gpt_pro"      # Consistency checking
# checklist = "gpt_pro"    # Quality scoring

# Subagent command overrides
[[subagents.commands]]
name = "plan"
read_only = true
agents = ["claude", "gemini", "code"]

[[subagents.commands]]
name = "implement"
read_only = false
agents = ["gemini", "claude", "gpt_codex", "gpt_pro"]

# Sandbox configuration
sandbox_mode = "workspace-write"

# Shell environment policy
[shell_environment_policy]
mode = "inherit"

# Spec-Kit automation settings (SPEC-KIT-922)
# These can be configured via environment variables set here
# Example: [shell_environment_policy.set]
# SPEC_KIT_AUTO_COMMIT = "true"  # Enable auto-commit (default: true)
# SPEC_KIT_TELEMETRY_ENABLED = "true"  # Enable telemetry (default: false)

# Notifications (optional)
# notify = ["notify-send", "Codex"]

# TUI configuration
[tui]
theme = "dark"
