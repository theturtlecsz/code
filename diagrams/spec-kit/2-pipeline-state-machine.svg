<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.0.2 (0)
 -->
<!-- Title: spec_kit_pipeline_v2 Pages: 1 -->
<svg width="759pt" height="2546pt"
 viewBox="0.00 0.00 759.00 2546.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2541.9)">
<title>spec_kit_pipeline_v2</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2541.9 755.25,-2541.9 755.25,4 -4,4"/>
<text xml:space="preserve" text-anchor="middle" x="375.62" y="-2520.6" font-family="Arial" font-size="14.00">Spec&#45;Kit Pipeline State Machine v2</text>
<text xml:space="preserve" text-anchor="middle" x="375.62" y="-2505.6" font-family="Arial" font-size="14.00">ACE&#45;Enhanced, No Retries, Strategic Quality Gates</text>
<g id="clust1" class="cluster">
<title>cluster_legend</title>
<polygon fill="#f5f5f5" stroke="black" points="545.25,-2059.36 545.25,-2491.9 743.25,-2491.9 743.25,-2059.36 545.25,-2059.36"/>
<text xml:space="preserve" text-anchor="middle" x="644.25" y="-2474.6" font-family="Arial" font-size="14.00">Pipeline v2 Changes</text>
</g>
<!-- init -->
<g id="node1" class="node">
<title>init</title>
<ellipse fill="#e3f2fd" stroke="black" cx="403.25" cy="-2442.9" rx="134.35" ry="48.08"/>
<text xml:space="preserve" text-anchor="middle" x="403.25" y="-2459.6" font-family="Arial" font-size="14.00">/speckit.auto SPEC&#45;ID</text>
<text xml:space="preserve" text-anchor="middle" x="403.25" y="-2444.6" font-family="Arial" font-size="14.00">• Validate config</text>
<text xml:space="preserve" text-anchor="middle" x="403.25" y="-2429.6" font-family="Arial" font-size="14.00">• Initialize state</text>
<text xml:space="preserve" text-anchor="middle" x="403.25" y="-2414.6" font-family="Arial" font-size="14.00">• Enable ACE + quality gates</text>
</g>
<!-- stage_check -->
<g id="node2" class="node">
<title>stage_check</title>
<polygon fill="#fff9c4" stroke="black" points="403.25,-2357.81 340.75,-2319.81 403.25,-2281.81 465.75,-2319.81 403.25,-2357.81"/>
<text xml:space="preserve" text-anchor="middle" x="403.25" y="-2321.51" font-family="Arial" font-size="14.00">More</text>
<text xml:space="preserve" text-anchor="middle" x="403.25" y="-2306.51" font-family="Arial" font-size="14.00">stages?</text>
</g>
<!-- init&#45;&gt;stage_check -->
<g id="edge1" class="edge">
<title>init&#45;&gt;stage_check</title>
<path fill="none" stroke="black" d="M403.25,-2394.39C403.25,-2386.19 403.25,-2377.66 403.25,-2369.44"/>
<polygon fill="black" stroke="black" points="406.75,-2369.59 403.25,-2359.59 399.75,-2369.59 406.75,-2369.59"/>
</g>
<!-- complete -->
<g id="node3" class="node">
<title>complete</title>
<ellipse fill="#c8e6c9" stroke="black" cx="195.25" cy="-2197.84" rx="106.77" ry="37.48"/>
<text xml:space="preserve" text-anchor="middle" x="195.25" y="-2207.04" font-family="Arial" font-size="14.00">Pipeline Complete</text>
<text xml:space="preserve" text-anchor="middle" x="195.25" y="-2192.04" font-family="Arial" font-size="14.00">• Finalize quality gates</text>
<text xml:space="preserve" text-anchor="middle" x="195.25" y="-2177.04" font-family="Arial" font-size="14.00">• Success message</text>
</g>
<!-- stage_check&#45;&gt;complete -->
<g id="edge2" class="edge">
<title>stage_check&#45;&gt;complete</title>
<path fill="none" stroke="black" d="M371.66,-2300.59C342.03,-2283.5 296.84,-2257.43 259.61,-2235.96"/>
<polygon fill="black" stroke="black" points="261.56,-2233.05 251.15,-2231.08 258.06,-2239.11 261.56,-2233.05"/>
<text xml:space="preserve" text-anchor="middle" x="311.86" y="-2254.31" font-family="Arial" font-size="10.00">No</text>
</g>
<!-- ace_prefetch -->
<g id="node4" class="node">
<title>ace_prefetch</title>
<polygon fill="#e1bee7" stroke="black" stroke-width="2" points="486.25,-2231.84 320.25,-2231.84 320.25,-2163.84 486.25,-2163.84 486.25,-2231.84"/>
<text xml:space="preserve" text-anchor="middle" x="403.25" y="-2214.54" font-family="Arial" font-size="14.00">ACE Pre&#45;fetch</text>
<text xml:space="preserve" text-anchor="middle" x="403.25" y="-2199.54" font-family="Arial" font-size="14.00">• Get playbook bullets</text>
<text xml:space="preserve" text-anchor="middle" x="403.25" y="-2184.54" font-family="Arial" font-size="14.00">• Cache in state</text>
<text xml:space="preserve" text-anchor="middle" x="403.25" y="-2169.54" font-family="Arial" font-size="14.00">• Scope: speckit.&lt;stage&gt;</text>
</g>
<!-- stage_check&#45;&gt;ace_prefetch -->
<g id="edge3" class="edge">
<title>stage_check&#45;&gt;ace_prefetch</title>
<path fill="none" stroke="black" d="M403.25,-2281.51C403.25,-2269.4 403.25,-2255.84 403.25,-2243.26"/>
<polygon fill="black" stroke="black" points="406.75,-2243.56 403.25,-2233.56 399.75,-2243.56 406.75,-2243.56"/>
<text xml:space="preserve" text-anchor="middle" x="411.5" y="-2254.31" font-family="Arial" font-size="10.00">Yes</text>
</g>
<!-- qg_check -->
<g id="node5" class="node">
<title>qg_check</title>
<polygon fill="#ffe082" stroke="black" points="398.25,-2123.36 306.5,-2085.36 398.25,-2047.36 490,-2085.36 398.25,-2123.36"/>
<text xml:space="preserve" text-anchor="middle" x="398.25" y="-2087.06" font-family="Arial" font-size="14.00">Quality Gate</text>
<text xml:space="preserve" text-anchor="middle" x="398.25" y="-2072.06" font-family="Arial" font-size="14.00">Checkpoint?</text>
</g>
<!-- ace_prefetch&#45;&gt;qg_check -->
<g id="edge4" class="edge">
<title>ace_prefetch&#45;&gt;qg_check</title>
<path fill="none" stroke="black" d="M401.74,-2163.39C401.32,-2154.26 400.87,-2144.19 400.42,-2134.42"/>
<polygon fill="black" stroke="black" points="403.93,-2134.5 399.98,-2124.67 396.94,-2134.82 403.93,-2134.5"/>
</g>
<!-- qg_execute -->
<g id="node6" class="node">
<title>qg_execute</title>
<polygon fill="#ffccbc" stroke="black" points="377.62,-2000.86 198.88,-2000.86 198.88,-1902.86 377.62,-1902.86 377.62,-2000.86"/>
<text xml:space="preserve" text-anchor="middle" x="288.25" y="-1983.56" font-family="Arial" font-size="14.00">Execute Quality Gate</text>
<text xml:space="preserve" text-anchor="middle" x="288.25" y="-1968.56" font-family="Arial" font-size="14.00">• BeforeSpecify: Clarify</text>
<text xml:space="preserve" text-anchor="middle" x="288.25" y="-1953.56" font-family="Arial" font-size="14.00">• AfterSpecify: Checklist</text>
<text xml:space="preserve" text-anchor="middle" x="288.25" y="-1938.56" font-family="Arial" font-size="14.00">• AfterTasks: Analyze</text>
<text xml:space="preserve" text-anchor="middle" x="288.25" y="-1923.56" font-family="Arial" font-size="14.00">• Spawn 3 agents</text>
<text xml:space="preserve" text-anchor="middle" x="288.25" y="-1908.56" font-family="Arial" font-size="14.00">• ACE&#45;enhanced resolution</text>
</g>
<!-- qg_check&#45;&gt;qg_execute -->
<g id="edge5" class="edge">
<title>qg_check&#45;&gt;qg_execute</title>
<path fill="none" stroke="black" d="M375.19,-2056.79C363.71,-2043.07 349.39,-2025.95 335.7,-2009.59"/>
<polygon fill="black" stroke="black" points="338.69,-2007.71 329.59,-2002.28 333.32,-2012.2 338.69,-2007.71"/>
<text xml:space="preserve" text-anchor="middle" x="358.09" y="-2019.86" font-family="Arial" font-size="10.00">Yes</text>
</g>
<!-- guardrail -->
<g id="node10" class="node">
<title>guardrail</title>
<polygon fill="#b3e5fc" stroke="black" points="444.88,-1552.86 303.62,-1552.86 303.62,-1484.86 444.88,-1484.86 444.88,-1552.86"/>
<text xml:space="preserve" text-anchor="middle" x="374.25" y="-1535.56" font-family="Arial" font-size="14.00">Phase: Guardrail</text>
<text xml:space="preserve" text-anchor="middle" x="374.25" y="-1520.56" font-family="Arial" font-size="14.00">• Execute shell script</text>
<text xml:space="preserve" text-anchor="middle" x="374.25" y="-1505.56" font-family="Arial" font-size="14.00">• Validate policy</text>
<text xml:space="preserve" text-anchor="middle" x="374.25" y="-1490.56" font-family="Arial" font-size="14.00">• Write telemetry</text>
</g>
<!-- qg_check&#45;&gt;guardrail -->
<g id="edge6" class="edge">
<title>qg_check&#45;&gt;guardrail</title>
<path fill="none" stroke="black" d="M404.39,-2049.6C408.54,-2023.16 413.25,-1985.83 413.25,-1952.86 413.25,-1952.86 413.25,-1952.86 413.25,-1607.86 413.25,-1592.55 408.25,-1576.92 401.84,-1563.17"/>
<polygon fill="black" stroke="black" points="405.04,-1561.74 397.39,-1554.4 398.79,-1564.9 405.04,-1561.74"/>
<text xml:space="preserve" text-anchor="middle" x="419.62" y="-1765.11" font-family="Arial" font-size="10.00">No</text>
</g>
<!-- qg_process -->
<g id="node7" class="node">
<title>qg_process</title>
<polygon fill="#ffab91" stroke="black" points="385.5,-1865.86 143,-1865.86 143,-1797.86 385.5,-1797.86 385.5,-1865.86"/>
<text xml:space="preserve" text-anchor="middle" x="264.25" y="-1848.56" font-family="Arial" font-size="14.00">Process Issues</text>
<text xml:space="preserve" text-anchor="middle" x="264.25" y="-1833.56" font-family="Arial" font-size="14.00">• Auto&#45;resolve (55%→70% with ACE)</text>
<text xml:space="preserve" text-anchor="middle" x="264.25" y="-1818.56" font-family="Arial" font-size="14.00">• GPT&#45;5 validate (35%)</text>
<text xml:space="preserve" text-anchor="middle" x="264.25" y="-1803.56" font-family="Arial" font-size="14.00">• Escalate (5&#45;10%)</text>
</g>
<!-- qg_execute&#45;&gt;qg_process -->
<g id="edge7" class="edge">
<title>qg_execute&#45;&gt;qg_process</title>
<path fill="none" stroke="black" d="M278.42,-1902.52C276.73,-1894.22 274.98,-1885.62 273.31,-1877.42"/>
<polygon fill="black" stroke="black" points="276.75,-1876.75 271.32,-1867.64 269.89,-1878.14 276.75,-1876.75"/>
</g>
<!-- qg_human -->
<g id="node8" class="node">
<title>qg_human</title>
<polygon fill="#ff8a65" stroke="black" points="290.49,-1740.86 178.75,-1740.86 150.01,-1664.86 261.75,-1664.86 290.49,-1740.86"/>
<text xml:space="preserve" text-anchor="middle" x="220.25" y="-1704.56" font-family="Arial" font-size="14.00">Human</text>
<text xml:space="preserve" text-anchor="middle" x="220.25" y="-1689.56" font-family="Arial" font-size="14.00">Decision</text>
</g>
<!-- qg_process&#45;&gt;qg_human -->
<g id="edge9" class="edge">
<title>qg_process&#45;&gt;qg_human</title>
<path fill="none" stroke="black" d="M252.69,-1797.49C247.85,-1783.54 242.14,-1767.05 236.87,-1751.83"/>
<polygon fill="black" stroke="black" points="240.2,-1750.76 233.62,-1742.46 233.59,-1753.06 240.2,-1750.76"/>
<text xml:space="preserve" text-anchor="middle" x="267.94" y="-1770.36" font-family="Arial" font-size="10.00">Escalated</text>
<text xml:space="preserve" text-anchor="middle" x="267.94" y="-1759.86" font-family="Arial" font-size="10.00">(5&#45;10%)</text>
</g>
<!-- qg_done -->
<g id="node9" class="node">
<title>qg_done</title>
<polygon fill="#c5e1a5" stroke="black" points="372.12,-1627.86 280.38,-1627.86 280.38,-1589.86 372.12,-1589.86 372.12,-1627.86"/>
<text xml:space="preserve" text-anchor="middle" x="326.25" y="-1610.56" font-family="Arial" font-size="14.00">Quality Gate</text>
<text xml:space="preserve" text-anchor="middle" x="326.25" y="-1595.56" font-family="Arial" font-size="14.00">Complete</text>
</g>
<!-- qg_process&#45;&gt;qg_done -->
<g id="edge8" class="edge">
<title>qg_process&#45;&gt;qg_done</title>
<path fill="none" stroke="black" d="M285.2,-1797.59C288.23,-1791.83 291.06,-1785.78 293.25,-1779.86 310.8,-1732.44 319.53,-1673.96 323.46,-1639.41"/>
<polygon fill="black" stroke="black" points="326.91,-1640.07 324.49,-1629.76 319.95,-1639.33 326.91,-1640.07"/>
<text xml:space="preserve" text-anchor="middle" x="349.71" y="-1703.86" font-family="Arial" font-size="10.00">Auto&#45;resolved</text>
<text xml:space="preserve" text-anchor="middle" x="349.71" y="-1693.36" font-family="Arial" font-size="10.00">(55&#45;70%)</text>
</g>
<!-- qg_human&#45;&gt;qg_done -->
<g id="edge10" class="edge">
<title>qg_human&#45;&gt;qg_done</title>
<path fill="none" stroke="black" d="M262.14,-1665.5C273.63,-1655.53 285.84,-1644.93 296.49,-1635.69"/>
<polygon fill="black" stroke="black" points="298.62,-1638.48 303.88,-1629.28 294.03,-1633.19 298.62,-1638.48"/>
</g>
<!-- qg_done&#45;&gt;guardrail -->
<g id="edge11" class="edge">
<title>qg_done&#45;&gt;guardrail</title>
<path fill="none" stroke="black" d="M336.2,-1589.63C340.43,-1581.86 345.57,-1572.45 350.68,-1563.08"/>
<polygon fill="black" stroke="black" points="353.73,-1564.79 355.44,-1554.34 347.58,-1561.44 353.73,-1564.79"/>
</g>
<!-- guardrail_check -->
<g id="node11" class="node">
<title>guardrail_check</title>
<polygon fill="#ffe082" stroke="black" points="374.25,-1447.86 302,-1409.86 374.25,-1371.86 446.5,-1409.86 374.25,-1447.86"/>
<text xml:space="preserve" text-anchor="middle" x="374.25" y="-1411.56" font-family="Arial" font-size="14.00">Guardrail</text>
<text xml:space="preserve" text-anchor="middle" x="374.25" y="-1396.56" font-family="Arial" font-size="14.00">Passed?</text>
</g>
<!-- guardrail&#45;&gt;guardrail_check -->
<g id="edge12" class="edge">
<title>guardrail&#45;&gt;guardrail_check</title>
<path fill="none" stroke="black" d="M374.25,-1484.59C374.25,-1476.66 374.25,-1468.04 374.25,-1459.57"/>
<polygon fill="black" stroke="black" points="377.75,-1459.73 374.25,-1449.73 370.75,-1459.73 377.75,-1459.73"/>
</g>
<!-- guardrail_fail -->
<g id="node12" class="node">
<title>guardrail_fail</title>
<ellipse fill="#ffcdd2" stroke="black" cx="162.25" cy="-1287.88" rx="102" ry="37.48"/>
<text xml:space="preserve" text-anchor="middle" x="162.25" y="-1297.08" font-family="Arial" font-size="14.00">Halt: Guardrail Failed</text>
<text xml:space="preserve" text-anchor="middle" x="162.25" y="-1282.08" font-family="Arial" font-size="14.00">• Show error</text>
<text xml:space="preserve" text-anchor="middle" x="162.25" y="-1267.08" font-family="Arial" font-size="14.00">• Manual fix required</text>
</g>
<!-- guardrail_check&#45;&gt;guardrail_fail -->
<g id="edge14" class="edge">
<title>guardrail_check&#45;&gt;guardrail_fail</title>
<path fill="none" stroke="black" d="M340.19,-1389.58C309.67,-1372.31 264.1,-1346.52 226.72,-1325.37"/>
<polygon fill="black" stroke="black" points="228.65,-1322.44 218.22,-1320.56 225.2,-1328.53 228.65,-1322.44"/>
<text xml:space="preserve" text-anchor="middle" x="287.73" y="-1344.36" font-family="Arial" font-size="10.00">Failed</text>
</g>
<!-- agents_phase -->
<g id="node13" class="node">
<title>agents_phase</title>
<polygon fill="#c5cae9" stroke="black" points="486,-1321.88 282.5,-1321.88 282.5,-1253.88 486,-1253.88 486,-1321.88"/>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1304.58" font-family="Arial" font-size="14.00">Phase: ExecutingAgents</text>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1289.58" font-family="Arial" font-size="14.00">• Build prompt with ACE bullets</text>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1274.58" font-family="Arial" font-size="14.00">• Apply ACE routing</text>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1259.58" font-family="Arial" font-size="14.00">• Spawn agents</text>
</g>
<!-- guardrail_check&#45;&gt;agents_phase -->
<g id="edge13" class="edge">
<title>guardrail_check&#45;&gt;agents_phase</title>
<path fill="none" stroke="black" d="M377.22,-1373.19C378.27,-1360.69 379.45,-1346.49 380.54,-1333.36"/>
<polygon fill="black" stroke="black" points="384.01,-1333.92 381.35,-1323.67 377.03,-1333.34 384.01,-1333.92"/>
<text xml:space="preserve" text-anchor="middle" x="396.05" y="-1344.36" font-family="Arial" font-size="10.00">Passed</text>
</g>
<!-- prompt_build -->
<g id="node14" class="node">
<title>prompt_build</title>
<polygon fill="#9fa8da" stroke="black" points="463.5,-1213.41 305,-1213.41 305,-1145.41 463.5,-1145.41 463.5,-1213.41"/>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1196.11" font-family="Arial" font-size="14.00">Build Prompt</text>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1181.11" font-family="Arial" font-size="14.00">• Load artifacts</text>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1166.11" font-family="Arial" font-size="14.00">• Inject ACE bullets</text>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1151.11" font-family="Arial" font-size="14.00">• Add agent instructions</text>
</g>
<!-- agents_phase&#45;&gt;prompt_build -->
<g id="edge15" class="edge">
<title>agents_phase&#45;&gt;prompt_build</title>
<path fill="none" stroke="black" d="M384.25,-1253.49C384.25,-1244.47 384.25,-1234.56 384.25,-1225.03"/>
<polygon fill="black" stroke="black" points="387.75,-1225.2 384.25,-1215.2 380.75,-1225.2 387.75,-1225.2"/>
</g>
<!-- spawn_agents -->
<g id="node15" class="node">
<title>spawn_agents</title>
<polygon fill="#7986cb" stroke="black" points="474.38,-1108.41 294.12,-1108.41 294.12,-1040.41 474.38,-1040.41 474.38,-1108.41"/>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1091.11" font-family="Arial" font-size="14.00">Spawn Agents</text>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1076.11" font-family="Arial" font-size="14.00">• Gemini, Claude, GPT&#45;Pro</text>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1061.11" font-family="Arial" font-size="14.00">• [+GPT&#45;Codex if Tier 3]</text>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-1046.11" font-family="Arial" font-size="14.00">• Parallel execution</text>
</g>
<!-- prompt_build&#45;&gt;spawn_agents -->
<g id="edge16" class="edge">
<title>prompt_build&#45;&gt;spawn_agents</title>
<path fill="none" stroke="black" d="M384.25,-1144.97C384.25,-1137.06 384.25,-1128.51 384.25,-1120.19"/>
<polygon fill="black" stroke="black" points="387.75,-1120.19 384.25,-1110.19 380.75,-1120.19 387.75,-1120.19"/>
</g>
<!-- agents_wait -->
<g id="node16" class="node">
<title>agents_wait</title>
<polygon fill="#5c6bc0" stroke="black" points="472.37,-1003.41 332.19,-1003.41 296.13,-927.41 436.31,-927.41 472.37,-1003.41"/>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-967.11" font-family="Arial" font-size="14.00">Wait for</text>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-952.11" font-family="Arial" font-size="14.00">Completion</text>
</g>
<!-- spawn_agents&#45;&gt;agents_wait -->
<g id="edge17" class="edge">
<title>spawn_agents&#45;&gt;agents_wait</title>
<path fill="none" stroke="black" d="M384.25,-1040.14C384.25,-1032.21 384.25,-1023.58 384.25,-1015.12"/>
<polygon fill="black" stroke="black" points="387.75,-1015.27 384.25,-1005.27 380.75,-1015.27 387.75,-1015.27"/>
</g>
<!-- agents_check -->
<g id="node17" class="node">
<title>agents_check</title>
<polygon fill="#ffe082" stroke="black" points="384.25,-890.41 297.75,-852.41 384.25,-814.41 470.75,-852.41 384.25,-890.41"/>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-854.11" font-family="Arial" font-size="14.00">All agents</text>
<text xml:space="preserve" text-anchor="middle" x="384.25" y="-839.11" font-family="Arial" font-size="14.00">completed?</text>
</g>
<!-- agents_wait&#45;&gt;agents_check -->
<g id="edge18" class="edge">
<title>agents_wait&#45;&gt;agents_check</title>
<path fill="none" stroke="black" d="M384.25,-927.14C384.25,-919.08 384.25,-910.45 384.25,-902.04"/>
<polygon fill="black" stroke="black" points="387.75,-902.28 384.25,-892.28 380.75,-902.28 387.75,-902.28"/>
</g>
<!-- agents_degrade -->
<g id="node18" class="node">
<title>agents_degrade</title>
<polygon fill="#fff9c4" stroke="black" points="352.5,-767.91 158,-767.91 158,-699.91 352.5,-699.91 352.5,-767.91"/>
<text xml:space="preserve" text-anchor="middle" x="255.25" y="-750.61" font-family="Arial" font-size="14.00">Degraded Mode</text>
<text xml:space="preserve" text-anchor="middle" x="255.25" y="-735.61" font-family="Arial" font-size="14.00">• 2/3 consensus acceptable</text>
<text xml:space="preserve" text-anchor="middle" x="255.25" y="-720.61" font-family="Arial" font-size="14.00">• Schedule follow&#45;up checklist</text>
<text xml:space="preserve" text-anchor="middle" x="255.25" y="-705.61" font-family="Arial" font-size="14.00">• Continue pipeline</text>
</g>
<!-- agents_check&#45;&gt;agents_degrade -->
<g id="edge20" class="edge">
<title>agents_check&#45;&gt;agents_degrade</title>
<path fill="none" stroke="black" d="M356.58,-826.41C340.27,-811.69 319.24,-792.7 300.57,-775.83"/>
<polygon fill="black" stroke="black" points="303.07,-773.38 293.31,-769.27 298.38,-778.57 303.07,-773.38"/>
<text xml:space="preserve" text-anchor="middle" x="337" y="-786.91" font-family="Arial" font-size="10.00">Failures</text>
</g>
<!-- consensus_phase -->
<g id="node19" class="node">
<title>consensus_phase</title>
<polygon fill="#a5d6a7" stroke="black" points="367,-662.91 181.5,-662.91 181.5,-594.91 367,-594.91 367,-662.91"/>
<text xml:space="preserve" text-anchor="middle" x="274.25" y="-645.61" font-family="Arial" font-size="14.00">Phase: CheckingConsensus</text>
<text xml:space="preserve" text-anchor="middle" x="274.25" y="-630.61" font-family="Arial" font-size="14.00">• Query local&#45;memory</text>
<text xml:space="preserve" text-anchor="middle" x="274.25" y="-615.61" font-family="Arial" font-size="14.00">• Synthesize results</text>
<text xml:space="preserve" text-anchor="middle" x="274.25" y="-600.61" font-family="Arial" font-size="14.00">• Validate agreement</text>
</g>
<!-- agents_check&#45;&gt;consensus_phase -->
<g id="edge19" class="edge">
<title>agents_check&#45;&gt;consensus_phase</title>
<path fill="none" stroke="black" d="M385.93,-814.7C385.8,-782.41 381.54,-735.19 361.25,-699.91 354.97,-688.99 346.27,-679.1 336.79,-670.43"/>
<polygon fill="black" stroke="black" points="339.31,-667.98 329.45,-664.11 334.75,-673.29 339.31,-667.98"/>
<text xml:space="preserve" text-anchor="middle" x="396.89" y="-729.66" font-family="Arial" font-size="10.00">All OK</text>
</g>
<!-- agents_degrade&#45;&gt;consensus_phase -->
<g id="edge21" class="edge">
<title>agents_degrade&#45;&gt;consensus_phase</title>
<path fill="none" stroke="black" d="M261.42,-699.47C262.89,-691.47 264.49,-682.81 266.04,-674.4"/>
<polygon fill="black" stroke="black" points="269.47,-675.14 267.84,-664.67 262.58,-673.87 269.47,-675.14"/>
</g>
<!-- consensus_check -->
<g id="node20" class="node">
<title>consensus_check</title>
<polygon fill="#ffe082" stroke="black" points="274.25,-557.91 190.75,-519.91 274.25,-481.91 357.75,-519.91 274.25,-557.91"/>
<text xml:space="preserve" text-anchor="middle" x="274.25" y="-521.61" font-family="Arial" font-size="14.00">Consensus</text>
<text xml:space="preserve" text-anchor="middle" x="274.25" y="-506.61" font-family="Arial" font-size="14.00">OK?</text>
</g>
<!-- consensus_phase&#45;&gt;consensus_check -->
<g id="edge22" class="edge">
<title>consensus_phase&#45;&gt;consensus_check</title>
<path fill="none" stroke="black" d="M274.25,-594.64C274.25,-586.71 274.25,-578.08 274.25,-569.62"/>
<polygon fill="black" stroke="black" points="277.75,-569.77 274.25,-559.77 270.75,-569.77 277.75,-569.77"/>
</g>
<!-- consensus_degrade -->
<g id="node21" class="node">
<title>consensus_degrade</title>
<polygon fill="#fff9c4" stroke="black" points="146.5,-421.43 0,-421.43 0,-353.43 146.5,-353.43 146.5,-421.43"/>
<text xml:space="preserve" text-anchor="middle" x="73.25" y="-404.13" font-family="Arial" font-size="14.00">Degraded Consensus</text>
<text xml:space="preserve" text-anchor="middle" x="73.25" y="-389.13" font-family="Arial" font-size="14.00">• 2/3 majority</text>
<text xml:space="preserve" text-anchor="middle" x="73.25" y="-374.13" font-family="Arial" font-size="14.00">• Schedule checklist</text>
<text xml:space="preserve" text-anchor="middle" x="73.25" y="-359.13" font-family="Arial" font-size="14.00">• Continue</text>
</g>
<!-- consensus_check&#45;&gt;consensus_degrade -->
<g id="edge24" class="edge">
<title>consensus_check&#45;&gt;consensus_degrade</title>
<path fill="none" stroke="black" d="M240.61,-497.07C211.7,-478.3 169.28,-450.77 134.38,-428.11"/>
<polygon fill="black" stroke="black" points="136.32,-425.2 126.03,-422.69 132.51,-431.07 136.32,-425.2"/>
<text xml:space="preserve" text-anchor="middle" x="206.78" y="-454.41" font-family="Arial" font-size="10.00">Degraded</text>
<text xml:space="preserve" text-anchor="middle" x="206.78" y="-443.91" font-family="Arial" font-size="10.00">(2/3)</text>
</g>
<!-- consensus_fail -->
<g id="node22" class="node">
<title>consensus_fail</title>
<ellipse fill="#ffcdd2" stroke="black" cx="274.25" cy="-387.43" rx="109.96" ry="37.48"/>
<text xml:space="preserve" text-anchor="middle" x="274.25" y="-396.63" font-family="Arial" font-size="14.00">Halt: Consensus Failed</text>
<text xml:space="preserve" text-anchor="middle" x="274.25" y="-381.63" font-family="Arial" font-size="14.00">• Show conflicts</text>
<text xml:space="preserve" text-anchor="middle" x="274.25" y="-366.63" font-family="Arial" font-size="14.00">• Manual resolution</text>
</g>
<!-- consensus_check&#45;&gt;consensus_fail -->
<g id="edge25" class="edge">
<title>consensus_check&#45;&gt;consensus_fail</title>
<path fill="none" stroke="black" d="M274.25,-481.52C274.25,-467.61 274.25,-451.63 274.25,-436.88"/>
<polygon fill="black" stroke="black" points="277.75,-436.89 274.25,-426.89 270.75,-436.89 277.75,-436.89"/>
<text xml:space="preserve" text-anchor="middle" x="287.38" y="-454.41" font-family="Arial" font-size="10.00">Failed</text>
<text xml:space="preserve" text-anchor="middle" x="287.38" y="-443.91" font-family="Arial" font-size="10.00">(&lt;2/3)</text>
</g>
<!-- validate_check -->
<g id="node25" class="node">
<title>validate_check</title>
<polygon fill="#ffe082" stroke="black" points="314.25,-312.95 242.75,-274.95 314.25,-236.95 385.75,-274.95 314.25,-312.95"/>
<text xml:space="preserve" text-anchor="middle" x="314.25" y="-276.65" font-family="Arial" font-size="14.00">Stage ==</text>
<text xml:space="preserve" text-anchor="middle" x="314.25" y="-261.65" font-family="Arial" font-size="14.00">Validate?</text>
</g>
<!-- consensus_check&#45;&gt;validate_check -->
<g id="edge23" class="edge">
<title>consensus_check&#45;&gt;validate_check</title>
<path fill="none" stroke="black" d="M314.33,-499.6C342.12,-483.79 376.95,-458.55 393.25,-424.91 407.77,-394.93 406.5,-380.52 393.25,-349.95 385.19,-331.36 369.9,-315.3 354.91,-302.94"/>
<polygon fill="black" stroke="black" points="357.39,-300.44 347.36,-297.03 353.08,-305.95 357.39,-300.44"/>
<text xml:space="preserve" text-anchor="middle" x="437.05" y="-383.18" font-family="Arial" font-size="10.00">Consensus OK</text>
</g>
<!-- consensus_degrade&#45;&gt;validate_check -->
<g id="edge26" class="edge">
<title>consensus_degrade&#45;&gt;validate_check</title>
<path fill="none" stroke="black" d="M146.21,-352.98C185.13,-335.14 231.93,-313.69 266.25,-297.96"/>
<polygon fill="black" stroke="black" points="267.47,-301.25 275.1,-293.9 264.55,-294.89 267.47,-301.25"/>
</g>
<!-- ace_feedback -->
<g id="node23" class="node">
<title>ace_feedback</title>
<polygon fill="#e1bee7" stroke="black" stroke-width="2" points="228.5,-176.48 82,-176.48 82,-108.48 228.5,-108.48 228.5,-176.48"/>
<text xml:space="preserve" text-anchor="middle" x="155.25" y="-159.18" font-family="Arial" font-size="14.00">ACE Learning</text>
<text xml:space="preserve" text-anchor="middle" x="155.25" y="-144.18" font-family="Arial" font-size="14.00">• Send feedback</text>
<text xml:space="preserve" text-anchor="middle" x="155.25" y="-129.18" font-family="Arial" font-size="14.00">• Update playbook</text>
<text xml:space="preserve" text-anchor="middle" x="155.25" y="-114.18" font-family="Arial" font-size="14.00">• Improve for next run</text>
</g>
<!-- advance -->
<g id="node24" class="node">
<title>advance</title>
<polygon fill="#b2dfdb" stroke="black" points="400.5,-68 272,-68 272,0 400.5,0 400.5,-68"/>
<text xml:space="preserve" text-anchor="middle" x="336.25" y="-50.7" font-family="Arial" font-size="14.00">Advance Stage</text>
<text xml:space="preserve" text-anchor="middle" x="336.25" y="-35.7" font-family="Arial" font-size="14.00">• Clear ACE cache</text>
<text xml:space="preserve" text-anchor="middle" x="336.25" y="-20.7" font-family="Arial" font-size="14.00">• Persist costs</text>
<text xml:space="preserve" text-anchor="middle" x="336.25" y="-5.7" font-family="Arial" font-size="14.00">• Next stage index</text>
</g>
<!-- ace_feedback&#45;&gt;advance -->
<g id="edge29" class="edge">
<title>ace_feedback&#45;&gt;advance</title>
<path fill="none" stroke="black" d="M212.02,-108.08C230.3,-97.33 250.71,-85.32 269.63,-74.19"/>
<polygon fill="black" stroke="black" points="271.22,-77.32 278.06,-69.23 267.67,-71.28 271.22,-77.32"/>
</g>
<!-- advance&#45;&gt;stage_check -->
<g id="edge30" class="edge">
<title>advance&#45;&gt;stage_check</title>
<path fill="none" stroke="black" d="M400.93,-45.64C453.24,-58.37 518.25,-85.47 518.25,-141.48 518.25,-2198.84 518.25,-2198.84 518.25,-2198.84 518.25,-2242.03 478.91,-2275.74 446.25,-2296.28"/>
<polygon fill="black" stroke="black" points="444.87,-2293.03 438.12,-2301.2 448.49,-2299.02 444.87,-2293.03"/>
</g>
<!-- validate_check&#45;&gt;ace_feedback -->
<g id="edge27" class="edge">
<title>validate_check&#45;&gt;ace_feedback</title>
<path fill="none" stroke="black" d="M286.55,-251.23C264.09,-232.79 231.86,-206.34 204.95,-184.26"/>
<polygon fill="black" stroke="black" points="207.17,-181.55 197.22,-177.92 202.73,-186.97 207.17,-181.55"/>
<text xml:space="preserve" text-anchor="middle" x="272.39" y="-204.2" font-family="Arial" font-size="10.00">Other stages</text>
</g>
<!-- validate_fail -->
<g id="node26" class="node">
<title>validate_fail</title>
<ellipse fill="#ffcdd2" stroke="black" cx="368.25" cy="-142.48" rx="122.15" ry="37.48"/>
<text xml:space="preserve" text-anchor="middle" x="368.25" y="-151.68" font-family="Arial" font-size="14.00">Halt: Validation Failed</text>
<text xml:space="preserve" text-anchor="middle" x="368.25" y="-136.68" font-family="Arial" font-size="14.00">• Manual review required</text>
<text xml:space="preserve" text-anchor="middle" x="368.25" y="-121.68" font-family="Arial" font-size="14.00">• Fix tests/implementation</text>
</g>
<!-- validate_check&#45;&gt;validate_fail -->
<g id="edge28" class="edge">
<title>validate_check&#45;&gt;validate_fail</title>
<path fill="none" stroke="black" d="M326.91,-243.36C333.48,-227.5 341.64,-207.78 348.97,-190.06"/>
<polygon fill="black" stroke="black" points="352,-191.88 352.59,-181.3 345.54,-189.21 352,-191.88"/>
<text xml:space="preserve" text-anchor="middle" x="361.73" y="-209.45" font-family="Arial" font-size="10.00">Validate</text>
<text xml:space="preserve" text-anchor="middle" x="361.73" y="-198.95" font-family="Arial" font-size="10.00">+ failed</text>
</g>
<!-- leg_ace -->
<g id="node27" class="node">
<title>leg_ace</title>
<polygon fill="#e1bee7" stroke="black" stroke-width="2" points="719.38,-2460.9 569.12,-2460.9 569.12,-2424.9 719.38,-2424.9 719.38,-2460.9"/>
<text xml:space="preserve" text-anchor="middle" x="644.25" y="-2437.1" font-family="Arial" font-size="14.00">NEW: ACE Integration</text>
</g>
<!-- leg_quality -->
<g id="node28" class="node">
<title>leg_quality</title>
<polygon fill="#ffccbc" stroke="black" points="722,-2337.81 566.5,-2337.81 566.5,-2301.81 722,-2301.81 722,-2337.81"/>
<text xml:space="preserve" text-anchor="middle" x="644.25" y="-2314.01" font-family="Arial" font-size="14.00">Strategic Quality Gates</text>
</g>
<!-- leg_ace&#45;&gt;leg_quality -->
<!-- leg_degrade -->
<g id="node29" class="node">
<title>leg_degrade</title>
<polygon fill="#fff9c4" stroke="black" points="735.5,-2215.84 553,-2215.84 553,-2179.84 735.5,-2179.84 735.5,-2215.84"/>
<text xml:space="preserve" text-anchor="middle" x="644.25" y="-2192.04" font-family="Arial" font-size="14.00">Degraded Mode (no retries)</text>
</g>
<!-- leg_quality&#45;&gt;leg_degrade -->
<!-- leg_halt -->
<g id="node30" class="node">
<title>leg_halt</title>
<path fill="#ffcdd2" stroke="black" d="M672.88,-2103.36C672.88,-2103.36 615.62,-2103.36 615.62,-2103.36 609.62,-2103.36 603.62,-2097.36 603.62,-2091.36 603.62,-2091.36 603.62,-2079.36 603.62,-2079.36 603.62,-2073.36 609.62,-2067.36 615.62,-2067.36 615.62,-2067.36 672.88,-2067.36 672.88,-2067.36 678.88,-2067.36 684.88,-2073.36 684.88,-2079.36 684.88,-2079.36 684.88,-2091.36 684.88,-2091.36 684.88,-2097.36 678.88,-2103.36 672.88,-2103.36"/>
<text xml:space="preserve" text-anchor="middle" x="644.25" y="-2079.56" font-family="Arial" font-size="14.00">Halt Points</text>
</g>
<!-- leg_degrade&#45;&gt;leg_halt -->
</g>
</svg>
